<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Big Excel Creator | BigExcelCreator </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Big Excel Creator | BigExcelCreator ">
      
      
      <link rel="icon" href="favicon.ico">
      <link rel="stylesheet" href="public/docfx.min.css">
      <link rel="stylesheet" href="public/main.css">
      <meta name="docfx:navrel" content="toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="">
      
      
      <meta name="docfx:docurl" content="https://github.com/fenase/BigExcelCreator/blob/3.2/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="index.html">
            <img id="logo" class="svg" src="logo.svg" alt="BigExcelCreator">
            BigExcelCreator
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="big-excel-creator">Big Excel Creator</h1>

<p>Create Excel files using OpenXML SAX with styling.
This is specially useful when trying to output thousands of rows.</p>
<p>The idea behind this package is to be a basic easy-to-use wrapper around a reduced subset of functions of
<a href="https://www.nuget.org/packages/DocumentFormat.OpenXml">DocumentFormat.OpenXml</a>
aimed towards generating large excel files as fast as possible using the SAX method for writing.</p>
<p>At the same time, this writer should prevent you from creating an invalid file
(i.e.: a file generated without any errors, but unable to be opened).
Since the most common reason for a file to become corrupted when creating it using SAX is out-of-order instructions
(i.e.: writing to a cell outside a sheet), this package should detect that, and throw an exception.</p>
<table>
<thead>
<tr>
<th><a href="https://fenase.github.io/projects/BigExcelCreator">More info</a></th>
<th><a href="https://fenase.github.io/BigExcelCreator/api/BigExcelCreator.html">API</a></th>
</tr>
</thead>
</table>
<blockquote>
<h3 id="note">NOTE</h3>
<p>Version 2.x of this package is linked to
version <a href="https://www.nuget.org/packages/DocumentFormat.OpenXml/2.18.0">2.18 of DocumentFormat.OpenXml</a>,
and starting on version 3, BigExcelCreator is linked to
version <a href="https://www.nuget.org/packages/DocumentFormat.OpenXml">3 of DocumentFormat.OpenXml</a>.</p>
<p>If you're already using DocumentFormat.OpenXml v2, either directly or as transitive reference,
and you can't upgrade for some reason (e.g. dependency on another package),
use <a href="https://www.nuget.org/packages/BigExcelCreator/2.2.2022.32620">BigExcelCreator v2</a></p>
<p>Otherwise, I recommend using the latest version available.</p>
</blockquote>
<p><a href="https://www.nuget.org/packages/BigExcelCreator"><img src="https://img.shields.io/nuget/v/BigExcelCreator" alt="Nuget"></a>
<a href="https://dev.azure.com/fenase/BigExcelCreator/_build/latest?definitionId=18&amp;branchName=main"><img src="https://dev.azure.com/fenase/BigExcelCreator/_apis/build/status%2FBigExcelCreator-CI?branchName=main" alt="Build Status"></a>
<a href="https://sonarcloud.io/summary/overall?id=fenase_BigExcelCreator"><img src="https://sonarcloud.io/api/project_badges/measure?project=fenase_BigExcelCreator&amp;metric=alert_status" alt="Quality Gate Status"></a>
<a href="https://sonarcloud.io/summary/overall?id=fenase_BigExcelCreator"><img src="https://sonarcloud.io/api/project_badges/measure?project=fenase_BigExcelCreator&amp;metric=ncloc" alt="Lines of Code"></a>
<a href="https://sonarcloud.io/summary/overall?id=fenase_BigExcelCreator"><img src="https://sonarcloud.io/api/project_badges/measure?project=fenase_BigExcelCreator&amp;metric=coverage" alt="Coverage"></a></p>
<h1 id="table-of-contents">Table of Contents</h1>
<ul>
<li><a href="#usage">Usage</a>
<ul>
<li><a href="#shared-strings">Shared Strings</a></li>
</ul>
</li>
<li><a href="#data-validation">Data Validation</a></li>
<li><a href="#styling-and-formatting">Styling and formatting</a>
<ul>
<li><a href="#column-formatting">Column formatting</a></li>
<li><a href="#hide-sheet">Hide Sheet</a></li>
<li><a href="#merge-cells">Merge Cells</a></li>
<li><a href="#styling">Styling</a></li>
<li><a href="#comments">Comments</a></li>
<li><a href="#autofilter">Autofilter</a></li>
<li><a href="#conditional-formatting">Conditional Formatting</a>
<ul>
<li><a href="#formula">Formula</a></li>
<li><a href="#cell-is">Cell Is</a></li>
<li><a href="#duplicated-values">Duplicated Values</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#page-layout">Page Layout</a>
<ul>
<li><a href="#sheet-options">Sheet options</a>
<ul>
<li><a href="#gridlines">Gridlines</a></li>
<li><a href="#headings">Headings</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="usage">Usage</h1>
<blockquote>
<p>To see a working example, see the <a href="https://github.com/fenase/BigExcelCreator/blob/main/Example/Program.cs">example code</a>
on gitHub, part of the vs solution.</p>
</blockquote>
<ol>
<li><p>Instantiate class <code>BigExcelWriter</code> using either a file path or a stream (<code>MemoryStream</code> is recommended).</p>
</li>
<li><p>Open a new Sheet using <code>CreateAndOpenSheet</code></p>
</li>
<li><p>For every row, use <code>BeginRow</code> and <code>EndRow</code></p>
<ul>
<li>If you want to hide a row, pass <code>true</code> when calling <code>BeginRow</code></li>
</ul>
</li>
<li><p>Between <code>BeginRow</code> and <code>EndRow</code>, use <code>WriteTextCell</code> to write a cell.</p>
<blockquote>
<p>Alternatively, you can use <code>WriteTextRow</code> to write an entire row at once, using the same format.</p>
</blockquote>
<blockquote>
<p>Starting on version 1.1, text cells can be written using the shared strings table, which should reduce the generated file size.
See <a href="#shared-strings">Shared Strings</a> below</p>
</blockquote>
</li>
<li><p>Use <code>WriteFormulaCell</code> or <code>WriteFormulaRow</code> to insert formulas.</p>
</li>
<li><p>Use <code>WriteNumberCell</code> or <code>WriteNumberRow</code> to insert numbers. This is useful if you need to do any calculation later on.</p>
</li>
<li><p>Use <code>CloseSheet</code> to finish.</p>
</li>
<li><p>If needed, repeat steps 2 -&gt; 5 to write to another sheet</p>
</li>
</ol>
<h2 id="shared-strings">Shared Strings</h2>
<p>If the same text appears across different sheets, using the shared strings table may help reduce the generated file size.
In order to do this, simply set to <code>true</code> the <code>useSharedStrings</code> parameter when calling <code>WriteTextCell</code> or <code>WriteTextRow</code>.</p>
<h2 id="example">Example</h2>
<pre><code class="lang-c#">using BigExcelCreator;

....

MemoryStream stream = new MemoryStream();
using (BigExcelWriter excel = new(stream, DocumentFormat.OpenXml.SpreadsheetDocumentType.Workbook))
{
    excel.CreateAndOpenSheet(&quot;Sheet Name&quot;);
    excel.BeginRow();
    excel.WriteTextCell(&quot;Cell content&quot;);
    excel.WriteTextCell(123); // write as number. This allows to use formulas.
    excel.WriteTextCell(456);
    excel.WriteFormulaCell(&quot;SUM(B1:C1)&quot;);
    excel.EndRow();
    excel.BeginRow(true);
    excel.WriteTextCell(&quot;This row is hidden&quot;);
    excel.EndRow();
    excel.CloseSheet();
}
</code></pre>
<h1 id="data-validation">Data Validation</h1>
<p>Use <code>AddListValidator</code> to restrict, to a list defined in a formula,
possible values to be written to a cell by an user.</p>
<p>Alternatively, use <code>AddIntegerValidator</code> or <code>AddDecimalValidator</code> to restrict / validate values
as defined by <code>validationType</code> (equal, greater than, between, etc.)</p>
<pre><code class="lang-c#">    excel.CreateAndOpenSheet(&quot;Sheet Name&quot;);
    
    ...    
    
    // Only allow values included in sheet named &quot;vals&quot; between cells A1 and A6
    // when writing to cells between B2 and B10 of the current sheet.
    string range = &quot;B2:B10&quot;;
    string formula = &quot;vals!$A$1:$A$6&quot;;
    excel.AddValidator(range, formula);
    
    excel.CloseSheet();
</code></pre>
<h1 id="styling-and-formatting">Styling and formatting</h1>
<h2 id="column-formatting">Column formatting</h2>
<p>When calling <code>CreateAndOpenSheet</code>, pass <code>IList&lt;Column&gt;</code> as second parameter.
Each element represents a single column.
Only the <code>CustomWidth</code>, <code>Width</code> and <code>Hidden</code> are used.</p>
<p><code>Width</code> represents the column width in characters (Same unit as when resizing in Excel).</p>
<p><code>CustomWidth</code> allows the use of <code>Width</code>.</p>
<p><code>Hidden</code> hides the column.</p>
<h3 id="example-1">Example</h3>
<pre><code class="lang-c#">List&lt;Column&gt; cols = new List&lt;Column&gt; {
    new Column{CustomWidth = true, Width=10},   // A
    new Column{CustomWidth = true, Width=15},   // B
    new Column{CustomWidth = true, Width=18},   // c
};

excel.CreateAndOpenSheet(&quot;Sheet Name&quot;, cols);

</code></pre>
<h2 id="hide-sheet">Hide Sheet</h2>
<p><code>CreateAndOpenSheet</code> accepts as third parameter a <code>SheetStateValues</code> variable.</p>
<ul>
<li><code>SheetStateValues.Visible</code> (default): Sheet is visible</li>
<li><code>SheetStateValues.Hidden</code>: Sheet is hidden</li>
<li><code>SheetStateValues.VeryHidden</code>: Sheet is hidden and cannot be unhidden from Excel's UI.</li>
</ul>
<h2 id="merge-cells">Merge Cells</h2>
<p>In order to merge a range of cells while a sheet is open, use <code>MergeCells</code> with a range.</p>
<pre><code class="lang-c#">excel.MergeCells(&quot;A1:A5&quot;);
</code></pre>
<h2 id="styling">Styling</h2>
<p>First, the elements that define a style (font, fill, border and, optionally, numbering format) must be created.</p>
<pre><code class="lang-c#">font1 = new Font(new Bold(),
            new FontSize { Val = 11 },
            new Color { Rgb = new HexBinaryValue { Value = &quot;000000&quot; } },
            new FontName { Val = &quot;Calibri&quot; });

fill1 = new Fill(
            new PatternFill { PatternType = PatternValues.Gray125 });
fill2 = new Fill(
            new PatternFill (
                new ForegroundColor { Rgb = new HexBinaryValue { Value = &quot;FFFF00&quot; } }
            )
            { PatternType = PatternValues.Solid });

border1 = new Border(
            new LeftBorder(
                new Color { Rgb = new HexBinaryValue { Value = &quot;FFD3D3D3&quot; } }
            )
            { Style = BorderStyleValues.Thin },
            new RightBorder(
                new Color { Rgb = new HexBinaryValue { Value = &quot;FFD3D3D3&quot; } }
            )
            { Style = BorderStyleValues.Thin },
            new TopBorder(
                new Color { Rgb = new HexBinaryValue { Value = &quot;FFD3D3D3&quot; } }
            )
            { Style = BorderStyleValues.Thin },
            new BottomBorder(
                new Color { Rgb = new HexBinaryValue { Value = &quot;FFD3D3D3&quot; } }
            )
            { Style = BorderStyleValues.Thin },
            new DiagonalBorder());

numberingFormat1 = new NumberingFormat { NumberFormatId = 164, FormatCode = &quot;0,.00;(0,.00)&quot; };
</code></pre>
<p>After that, a new style list can be created and new styles inserted. Remember to name you styles.</p>
<pre><code class="lang-c#">StyleList list = new StyleList();
string name1 = &quot;name1&quot;;
string name2 = &quot;name2&quot;;

list.NewStyle(font1, fill1, border1, numberingFormat1, name1);
list.NewStyle(font1, fill2, border1, numberingFormat1, name2);
</code></pre>
<p>When instantiating <code>BigExcelWriter</code>, use the result of calling <code>GetStylesheet</code> as the <code>stylesheet</code> parameter.
Then, when writing a cell, you can use the name given earlier to format it.</p>
<pre><code class="lang-c#">MemoryStream stream = new MemoryStream();
using (BigExcelWriter excel = new(stream,
                                    DocumentFormat.OpenXml.SpreadsheetDocumentType.Workbook
                                    stylesheet: list.GetStylesheet()))
{
    int index_style_name1 = list.GetIndexByName(name1);
    int index_style_name2 = list.GetIndexByName(name2);
    excel.CreateAndOpenSheet(&quot;Sheet Name&quot;);
    excel.BeginRow();
    excel.WriteTextCell(&quot;This has a gray patterned background&quot;, index_style_name1);
    excel.WriteTextCell(&quot;This has a yellow background&quot;, index_style_name2);
    excel.EndRow();
    excel.CloseSheet();
}
</code></pre>
<blockquote>
<p>If you're planning to use <a href="#conditional-formatting">Conditional Formatting</a>, you must also create differential styles here.
To do so, follow the same instructions as above, replacing <code>NewStyle</code> with <code>NewDifferentialStyle</code>.</p>
<p>All parameters of <code>NewDifferentialStyle</code> are optional, except <code>name</code>. Of the optional parameters, at least one must be present.</p>
</blockquote>
<pre><code class="lang-c#">// place this before calling list.GetStylesheet() and new BigExcelWriter()
list.NewDifferentialStyle(&quot;RED&quot;, font: new Font(new Color { Rgb = new HexBinaryValue { Value = &quot;FF0000&quot; } }));
</code></pre>
<h2 id="comments">Comments</h2>
<p>In order to add a note (formerly known as comment) to a cell, while a sheet is open, call the <code>Comment</code> method.</p>
<pre><code class="lang-c#">excel.CreateAndOpenSheet(&quot;Sheet Name&quot;);
excel.BeginRow();

excel.WriteTextCell(&quot;This has a gray patterned background&quot;, index_style_name1);
excel.WriteTextCell(&quot;This has a yellow background&quot;, index_style_name2);

excel.Comment(&quot;test A1 another sheet&quot;, &quot;A1&quot;);

excel.EndRow();

excel.Comment(&quot;test E2 another sheet&quot;, &quot;B1&quot;, &quot;Author&quot;);

excel.CloseSheet();
</code></pre>
<h2 id="autofilter">Autofilter</h2>
<p>In order to add an Autofilter, call <code>AddAutofilter</code> while on a sheet.</p>
<pre><code class="lang-c#">excel.BeginRow();
// ...
excel.AddAutofilter(range); // Range's height must be 1. Example: A1:J1
// ...
excel.EndRow();
</code></pre>
<h2 id="conditional-formatting">Conditional Formatting</h2>
<p>In order to use conditional formatting, you should define Differential styles (see <a href="#styling">Styling</a>)</p>
<blockquote>
<p>On every case below:</p>
<ul>
<li><code>reference</code> =&gt; A range of cells to apply the conditional formatting to</li>
<li><code>format</code> =&gt; The id of the Differential style. Obtain it using <code>GetIndexDifferentialByName</code> after creating it with <code>NewDifferentialStyle</code></li>
</ul>
</blockquote>
<h3 id="formula">Formula</h3>
<p>To define a conditional style by formula, use <code>AddConditionalFormattingFormula(string reference, string formula, int format)</code>.</p>
<ul>
<li><code>formula</code> defines the expression to use.
Use a fixed range using <code>$</code> to anchor the reference to a cell.
Avoid using <code>$</code> to make the reference &quot;walk&quot; with the range.
This is useful when referencing the current cell.</li>
</ul>
<pre><code class="lang-c#">excel.AddConditionalFormattingFormula(&quot;A1:A10&quot;, &quot;A1&lt;5&quot;, styleList.GetIndexDifferentialByName(&quot;RED&quot;));
</code></pre>
<h3 id="cell-is">Cell Is</h3>
<p>Format cells based on their contents using <code>AddConditionalFormattingCellIs</code></p>
<ul>
<li><code>Operator</code> defines how to compare values.</li>
<li><code>value</code> defines the value to compare the cell to.</li>
<li><code>value2</code> If the operator requires 2 numbers (eg: <code>Between</code> and <code>NotBetween</code>), the second value goes here.</li>
</ul>
<pre><code class="lang-c#">excel.AddConditionalFormattingCellIs(&quot;A1:A20&quot;, ConditionalFormattingOperatorValues.LessThan, &quot;5&quot;, styleList.GetIndexDifferentialByName(&quot;RED&quot;));
excel.AddConditionalFormattingCellIs(&quot;A1:A20&quot;, ConditionalFormattingOperatorValues.Between, &quot;3&quot;, styleList.GetIndexDifferentialByName(&quot;RED&quot;), &quot;7&quot;);
</code></pre>
<h3 id="duplicated-values">Duplicated Values</h3>
<p>Format duplicated values using <code>AddConditionalFormattingDuplicatedValues</code></p>
<pre><code class="lang-c#">excel.AddConditionalFormattingDuplicatedValues(&quot;A1:A10&quot;, styleList.GetIndexDifferentialByName(&quot;RED&quot;));
</code></pre>
<h1 id="page-layout">Page Layout</h1>
<h2 id="sheet-options">Sheet options</h2>
<h3 id="gridlines">Gridlines</h3>
<p>While working on a sheet, the property <code>ShowGridLinesInCurrentSheet</code> controls whether the gridlines are shown.
Enabled by default.</p>
<p>While working on a sheet, the property <code>PrintGridLinesInCurrentSheet</code> controls whether the gridlines are printed.
Disabled by default.</p>
<h3 id="headings">Headings</h3>
<p>While working on a sheet, the property <code>ShowRowAndColumnHeadingsInCurrentSheet</code> controls whether the headings (Column letters and row numbers) are shown.
Enabled by default.</p>
<p>While working on a sheet, the property <code>PrintRowAndColumnHeadingsInCurrentSheet</code> controls whether the headings (Column letters and row numbers) are printed.
Disabled by default.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/fenase/BigExcelCreator/blob/3.2/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
